<!doctype html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>{{ title }}</title>
        <script type="text/javascript" src="{{ url_for('.static', filename='js/jquery-3.4.1.min.js') }}"></script>
    </head>
    <body>
        <h1>{{ form_title }}</h1>
        
        <div class="container">
            {% block post_form_content %}

            <form
                id="post-form"
                method="post"
                action="{{ form_action }}"
                enctype="multipart/form-data">
                
                {{ post_form.csrf_token }}
                
                <div class="input">
                    {{ post_form.title.label }}
                    {{ post_form.title }}

                    {% if post_form.title.errors %}
                        <ul>
                            {% for error in post_form.title.errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>

                <div class="input">
                    {{ post_form.text.label }}
                    {{ post_form.text }}
                    
                    {% if post_form.text.errors %}
                        <ul>
                            {% for error in post_form.text.errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>

                <div class="input">
                    {{ post_form.image.label }}
                    {{ post_form.image }}

                    <img id="preview-img" style="visibility: {{ 'visible' if image_name else 'hidden' }};"
                    src="{{ url_for('.static', filename='images/news/{}'.format(image_name)) }}"/>

                    <script type="text/javascript">
                        function imgPreview(input) {
                            if (input.files && input.files[0]) {
                                var reader = new FileReader();
                                reader.onload = function (e) {
                                    $('#preview-img').attr('src', e.target.result);
                                    $('#preview-img').css('visibility', 'visible');
                                };
                                reader.readAsDataURL(input.files[0]);
                            }
                        }

                        $("#image").change(function () {
                            imgPreview(this);
                        });
                    </script>

                    {% if post_form.image.errors %}
                        <ul>
                            {% for error in post_form.image.errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>

                <button type="submit" class="btn submit">Postar</button>
            </form>
            
            {% with messages = get_flashed_messages() %}
                {% if messages %}
                    <ul>
                        {% for message in messages %}
                        <li>{{ message }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}
            {% endwith %}

            {% endblock %}
        </div>
        
    </body>
</html>